version: '3'

services:

  kali:
    image: estopl/kali:kali
    tty: true
    ports:
      - "7655:22"
    cap_add:
      - NET_ADMIN
    working_dir: /home/kali
    volumes:
      - ../volumes/local_kali:/var/lib/docker/volumes
    networks:
      testing_net:
        ipv4_address: 172.19.0.3

  mutillidae_db:
    image: mysql:5.5
    environment:
        MYSQL_ROOT_PASSWORD: mutillidae
        MYSQL_DATABASE: mutillidae
        MYSQL_USER: admin
        MYSQL_PASSWORD: admin
    volumes:
      - ../volumes/local_muti_db_data:var/lib/mysql
    networks:
      - testing_net

  mutillidae_web:
    image: crhystamils/mutillidae
    links:
        - mutillidae_db
    depends_on:
        - mutillidae_db
    networks:
      testing_net:
        ipv4_address: 172.19.1.3

  web_dvwa:
    image: vulnerables/web-dvwa
    networks:
      testing_net:
        ipv4_address: 172.19.1.4

  juice_shop:
    image: bkimminich/juice-shop
    networks:
      testing_net:
        ipv4_address: 172.19.1.5

  mysql:
    image: mysql:5
    volumes:
      - ../volumes/local_db_data:/var/lib/mysql
    environment: 
      - MYSQL_ROOT_PASSWORD=root
    networks:
      testing_net:
        ipv4_address: 172.19.1.7

  wordpress:
    image: estopl/wordpress:laura
    depends_on:
      - mysql
    volumes:
      - ../volumes/local_wordpress_data:/var/www/html
    environment: 
      - WORDPRESS_DB_HOST=mysql:3306
      - WORDPRESS_DB_USER=root
      - WORDPRESS_DB_PASSWORD=root
      - WORDPRESS_DB_NAME=wordpress
    ports:
      - "8080:80"
    networks:
      testing_net:
        ipv4_address: 172.19.1.6

  metasploitable2:
    tty: true
    image: estopl/metasploitable2-testing:latest
    # command: tail -f /dev/null
    cap_add:
      - NET_ADMIN
    working_dir: /root
    volumes:
      - ../volumes/local_meta/:/var/lib/docker/volumes
    networks:
      testing_net:
        ipv4_address: 172.19.1.8

volumes:
  local_kali: {}
  local_muti_db_data: {}
  local_db_data: {}
  local_wordpress_data: {}
  local_meta: {}

networks:
  testing_net:
    ipam:
      driver: default
      config:
      - subnet: 172.19.0.0/16
